const post=async e=>{try{const t=await fetch(obj.AJAX_URL,{method:"POST",credentials:"same-origin",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/x-www-form-urlencoded charset=UTF-8","X-Requested-With":"XMLHttpRequest"},body:new URLSearchParams(e).toString()});return await t.json()}catch(e){console.log(e)}},payPalCreateOrder=async(e,t)=>{try{const n=await fetch(obj.PAYPAL_ORDER,{method:"POST",headers:{"Content-Type":"application/json",Authorization:obj.PAYPAL_TOKEN},body:JSON.stringify({intent:"CAPTURE",purchase_units:[{amount:{currency_code:"USD",value:t}}],payment_source:{paypal:{experience_context:{payment_method_preference:"IMMEDIATE_PAYMENT_REQUIRED",brand_name:"nguoinghienchoidan",locale:"en-US",landing_page:"LOGIN",user_action:"PAY_NOW",return_url:`${obj.HOME_URL}/check-paypal-status?order-id=${e}`,cancel_url:window.location.href}}}})});return await n.json()}catch(e){console.log(e)}},payPalCheckOrder=async e=>{try{const t=await fetch(obj.PAYPAL_ORDER+"/"+e,{headers:{Authorization:obj.PAYPAL_TOKEN,"Content-Type":"application/json"}});return await t.json()}catch(e){console.log(e)}},payPalCaptureOrder=async e=>{try{const t=await fetch(obj.PAYPAL_ORDER+"/"+e+"/capture",{method:"POST",headers:{Authorization:obj.PAYPAL_TOKEN,"Content-Type":"application/json"}});return await t.json()}catch(e){console.log(e)}};document.addEventListener("DOMContentLoaded",()=>{new LazyLoad({});const e=document.querySelector("#btn-menu"),t=document.querySelector("#box-mobile-menu"),n=document.querySelectorAll("#box-mobile-menu ul li"),o=document.querySelector("#box-mobile-menu .overlay"),a=document.querySelector("#mobile-menu"),r=document.querySelector("#page");e.addEventListener("click",e=>{e.preventDefault(),t.classList.toggle("active"),a.classList.toggle("active"),r.classList.toggle("disable")}),o.addEventListener("click",e=>{e.preventDefault(),t.classList.toggle("active"),a.classList.toggle("active"),r.classList.toggle("disable")}),n.forEach(e=>{e.addEventListener("click",e=>{t.classList.toggle("active"),a.classList.toggle("active"),r.classList.toggle("disable")})});const i=document.querySelector("#btn-search"),c=document.querySelector("#search"),s=document.querySelector("#search .overlay");i.addEventListener("click",e=>{e.preventDefault(),c.classList.toggle("active")}),s.addEventListener("click",e=>{e.preventDefault(),c.classList.toggle("active")}),document.querySelectorAll(".btn-wish").forEach(e=>{e.addEventListener("click",async e=>{e.preventDefault();let t=e.currentTarget,n={action:"add_to_wishlist",nonce:t.getAttribute("data-nonce"),context:"frontend",add_to_wishlist:t.getAttribute("data-product-id"),product_type:t.getAttribute("data-product-type")};if(t.classList.toggle("pending"),"exists"!==(await post(n)).result){return t.classList.toggle("pending"),void Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:1500,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}).fire({icon:"success",title:obj.ADD_TO_WISHLIST})}t.classList.toggle("pending"),Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:1500,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}).fire({icon:"success",title:obj.ADD_TO_WISHLIST_EXIST})})});const l=document.querySelectorAll(".btn-cart"),d=document.querySelector("#left-cart .overlay"),u=document.querySelector("#left-cart");l.forEach(e=>{e.addEventListener("click",e=>{e.preventDefault();e.currentTarget;u.classList.toggle("active")})}),d.addEventListener("click",e=>{e.preventDefault();e.currentTarget;u.classList.toggle("active")}),document.querySelectorAll(".btn-add").forEach(e=>{e.addEventListener("click",async e=>{e.preventDefault();let t=e.currentTarget,n={action:"woocommerce_ajax_add_to_cart",nonce:t.getAttribute("data-nonce"),product_id:t.getAttribute("data-product-id")};t.classList.toggle("pending");const o=await post(n);if(o.success){return t.classList.toggle("pending"),document.querySelector(".cart-item-list").innerHTML=o.data,void u.classList.toggle("active")}t.classList.toggle("pending"),Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:1500,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}).fire({icon:"error",title:obj.ADD_TO_CART_FAILED})})});const g=document.querySelector(".left-cart");document.addEventListener("click",e=>{let t=e.target;document.querySelectorAll(".btn-remove-item").forEach(async n=>{if(n.contains(t)){e.preventDefault(),g.classList.toggle("--pending");let n=t,o={action:"woocommerce_ajax_remove_item_in_cart",nonce:n.getAttribute("data-nonce"),product_id:n.getAttribute("data-id")};const a=await post(o);if(a.success){return document.querySelector(".cart-item-list").innerHTML=a.data,void g.classList.toggle("--pending")}g.classList.toggle("--pending");Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:1500,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}})}})}),document.querySelectorAll(".btn-buy").forEach(e=>{e.addEventListener("click",async e=>{e.preventDefault();let t=e.currentTarget,n={action:"woocommerce_ajax_add_to_cart",nonce:t.getAttribute("data-nonce"),product_id:t.getAttribute("data-product-id")};if(t.classList.toggle("pending"),(await post(n)).success)return t.classList.toggle("pending"),void(window.location.href=obj.CART_URL)})})});